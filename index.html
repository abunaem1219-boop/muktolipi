<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶≤‡¶ø‡¶™‡¶ø ‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø</title>
    
    <!-- PWA Manifest & Meta Tags -->
    <meta name="theme-color" content="#1877f2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIuKbnOCljeCkpOCmsuCkv+CKr+Ckv+CqpSDgpqHgprLgp9uCprDgpL8iLAogICJzaG9ydF9uYW1lIjogIuKbnOCljeCkpOCmsuCkv+CKr+Ckv+CqpSIsCiAgInN0YXJ0X3VybCI6ICIuIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZmZmZmZmIiwKICAidGhlbWVfY29xvciI6ICIjMTg3N2YyIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiaHR0cHM6Ly9pLmliYi5jby9WV1ZtMFh5L011a3RvbGlwaS1CYW5uZXIuanBnIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9qcGVnIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL2kuaWJiLmNvL1ZXVm0wWHkvTXVrdG9saXBpLUJhbm5lci5qcGciLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL2pwZWciCiAgICB9CiAgXQp9">

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root { 
            --bg-color: #f0f2f5; 
            --card-bg: #ffffff; 
            --text-color: #1c1e21; 
            --primary-color: #1877f2; 
            --border-color: #ddd; 
            --secondary-text: #65676b; 
            --content-font-size: 16px; /* Default Font Size */
        }
        .dark-theme { --bg-color: #18191a; --card-bg: #242526; --text-color: #e4e6eb; --primary-color: #2d88ff; --border-color: #3e4042; --secondary-text: #b0b3b8; }

        body { font-family: 'Hind Siliguri', sans-serif; background: var(--bg-color); color: var(--text-color); margin: 0; padding: 10px; transition: 0.3s; user-select: none; -webkit-tap-highlight-color: transparent; padding-bottom: 100px; }

        /* Banner & Header */
        .app-banner { width: 100%; max-width: 981px; margin: 0 auto 20px auto; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .app-banner img { width: 100%; height: auto; aspect-ratio: 981 / 363; object-fit: cover; display: block; }

        header { text-align: center; padding: 15px; background: var(--card-bg); border-radius: 10px; margin-bottom: 20px; position: relative; box-shadow: 0 2px 4px rgba(0,0,0,0.1); max-width: 800px; margin-left: auto; margin-right: auto; }
        
        .header-controls { position: absolute; top: 15px; right: 15px; display: flex; gap: 15px; }
        .icon-btn { cursor: pointer; font-size: 20px; background: none; border: none; color: var(--text-color); transition: 0.2s; }
        .icon-btn:hover { color: var(--primary-color); }

        .container { max-width: 800px; margin: 0 auto; }
        
        /* Search */
        .search-wrapper { position: relative; width: 100%; margin-bottom: 10px; }
        #searchBar { width: 100%; padding: 12px 40px 12px 15px; border-radius: 25px; border: 1px solid var(--border-color); background: var(--card-bg); color: var(--text-color); outline: none; box-sizing: border-box; }
        .search-clear { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--secondary-text); cursor: pointer; display: none; font-size: 16px; padding: 5px; }

        /* Category Tabs */
        .category-tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 15px; scrollbar-width: none; }
        .category-tabs::-webkit-scrollbar { display: none; }
        .cat-btn { white-space: nowrap; padding: 6px 15px; border-radius: 20px; border: 1px solid var(--border-color); background: var(--card-bg); color: var(--text-color); cursor: pointer; font-size: 13px; transition: 0.2s; }
        .cat-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }

        /* Admin Panel */
        #adminPanel { display: none; background: var(--card-bg); padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 2px solid var(--primary-color); }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-color); color: var(--text-color); font-family: inherit; box-sizing: border-box; }
        
        .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-primary { background: var(--primary-color); color: white; width: 100%; font-size: 16px; }

        /* Post Card */
        .post-card { background: var(--card-bg); padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); position: relative; overflow: hidden; }
        .pinned-badge { position: absolute; top: 20px; right: 20px; color: #e74c3c; font-size: 18px; transform: rotate(45deg); }
        .category-tag { background: rgba(24, 119, 242, 0.1); color: var(--primary-color); padding: 2px 8px; border-radius: 4px; font-size: 11px; margin-left: 8px; }

        .author-info { font-size: 15px; font-weight: bold; color: var(--text-color); display: flex; align-items: center; gap: 10px; margin-bottom: 5px; }
        .date { font-size: 12px; color: var(--secondary-text); display: block; margin-bottom: 10px; }
        .post-title { font-size: 22px; margin: 5px 0 10px 0; font-weight: 700; line-height: 1.3; }
        
        /* Image & Content with Double Tap */
        .post-img-container { position: relative; width: 100%; }
        .post-img { width: 100%; border-radius: 8px; margin: 10px 0; cursor: pointer; transition: 0.3s; max-height: 400px; object-fit: cover; }
        
        /* Font Size Controlled via Variable */
        .content-preview { white-space: pre-line; line-height: 1.6; font-size: var(--content-font-size); color: var(--text-color); position: relative; transition: font-size 0.2s; }
        
        /* Heart Animation */
        .heart-popup { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); color: #e74c3c; font-size: 80px; animation: popHeart 0.8s ease-out; pointer-events: none; z-index: 10; opacity: 0; drop-shadow: 0 0 5px rgba(0,0,0,0.5); }
        @keyframes popHeart { 0% { transform: translate(-50%, -50%) scale(0); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; } }

        .read-more-btn { color: var(--primary-color); cursor: pointer; font-weight: bold; border: none; background: none; padding: 0; margin-top: 5px; }

        /* Audio Button in Card */
        .audio-trigger-btn { display: flex; align-items: center; gap: 10px; background: var(--bg-color); padding: 8px 15px; border-radius: 20px; border: 1px solid var(--primary-color); color: var(--primary-color); font-weight: bold; margin: 10px 0; cursor: pointer; width: fit-content; }
        .audio-trigger-btn:hover { background: var(--primary-color); color: white; }

        /* Interactions */
        .interaction-bar { display: flex; justify-content: space-between; border-top: 1px solid var(--border-color); padding-top: 10px; margin-top: 15px; }
        .action-btn { background: none; border: none; cursor: pointer; color: var(--secondary-text); font-size: 14px; display: flex; align-items: center; gap: 6px; padding: 5px; }
        .action-btn.liked { color: var(--primary-color); }
        .action-btn.bookmarked { color: #f39c12; }

        /* Floating Sticky Player */
        #stickyPlayer { 
            position: fixed; bottom: -100px; left: 0; width: 100%; 
            background: var(--card-bg); border-top: 2px solid var(--primary-color);
            padding: 10px 15px; box-sizing: border-box; box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
            display: flex; align-items: center; justify-content: space-between; 
            transition: bottom 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 1000;
        }
        #stickyPlayer.active { bottom: 0; }
        .player-info { display: flex; flex-direction: column; max-width: 60%; }
        .p-title { font-weight: bold; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--text-color); }
        .p-author { font-size: 12px; color: var(--secondary-text); }
        .player-controls { display: flex; gap: 15px; align-items: center; }
        .player-btn { background: none; border: none; font-size: 20px; color: var(--text-color); cursor: pointer; }
        .play-toggle { color: var(--primary-color); font-size: 28px; }

        /* Comments */
        .comment-area { display: none; margin-top: 15px; padding-top: 10px; border-top: 1px dotted var(--border-color); }
        .comment-item { background: var(--bg-color); padding: 8px 12px; border-radius: 12px; margin-bottom: 5px; font-size: 14px; width: fit-content; max-width: 90%; }
        
        /* Lightbox */
        .lightbox { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; display: none; justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s; }
        .lightbox.active { opacity: 1; }
        .lightbox img { max-width: 95%; max-height: 80vh; border-radius: 5px; }
        .close-lightbox { position: absolute; top: 20px; right: 20px; color: white; font-size: 30px; cursor: pointer; }

        /* Scroll To Top */
        #scrollTopBtn { display: none; position: fixed; bottom: 80px; right: 20px; background: var(--primary-color); color: white; border: none; border-radius: 50%; width: 45px; height: 45px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); font-size: 18px; z-index: 999; }
        
        #installBtn { display: none; background: var(--primary-color); color: white; border: none; padding: 8px 15px; border-radius: 20px; margin-top: 10px; font-size: 13px; cursor: pointer; }
        #loader { text-align: center; padding: 20px; color: var(--secondary-text); display: none; }
        .spinner { border: 4px solid rgba(0,0,0,0.1); border-left-color: var(--primary-color); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .no-results { text-align: center; padding: 40px 20px; color: var(--secondary-text); }
        .admin-controls { margin-top: 10px; text-align: right; font-size: 13px; }
    </style>
</head>
<body>

    <div id="lightbox" class="lightbox" onclick="closeLightbox()">
        <span class="close-lightbox">&times;</span>
        <img id="lightbox-img" src="" alt="Full View">
    </div>

    <!-- Sticky Floating Audio Player -->
    <div id="stickyPlayer">
        <div class="player-info">
            <span class="p-title" id="globalPlayerTitle">Title</span>
            <span class="p-author" id="globalPlayerAuthor">Author</span>
        </div>
        <div class="player-controls">
            <button class="player-btn play-toggle" onclick="toggleGlobalAudio()">
                <i class="fas fa-play" id="globalPlayIcon"></i>
            </button>
            <button class="player-btn" onclick="closeGlobalPlayer()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <audio id="globalAudioElement" onended="onAudioEnded()"></audio>
    </div>

    <button id="scrollTopBtn" onclick="window.scrollTo({top: 0, behavior: 'smooth'})"><i class="fas fa-arrow-up"></i></button>

    <div class="container">
        <div class="app-banner">
            <img src="my_banner.jpg" alt="Banner">
        </div>

        <header>
            <div class="header-controls">
                <!-- Font Size Resizer -->
                <button class="icon-btn" onclick="toggleFontSize()" title="‡¶´‡¶®‡ßç‡¶ü ‡¶∏‡¶æ‡¶á‡¶ú ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®"><i class="fas fa-text-height"></i></button>
                <button class="icon-btn theme-toggle" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
            </div>
            <h1 style="margin: 0; color: var(--primary-color);">‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶≤‡¶ø‡¶™‡¶ø ‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø</h1>
            <p style="margin: 5px 0 0 0; font-size: 14px; color: var(--secondary-text);">‡¶Æ‡¶®‡ßá‡¶∞ ‡¶ï‡¶•‡¶æ, ‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§ ‡¶≠‡¶æ‡¶∑‡¶æ‡ßü</p>
            <button id="installBtn" onclick="installPWA()"><i class="fas fa-download"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶á‡¶®‡ßç‡¶∏‡¶ü‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <button id="adminBtn" onclick="adminLogin()" style="margin-top:10px; background:none; border:none; color:gray; font-size:12px; cursor:pointer; display:block; margin: 5px auto;">Admin Access</button>
        </header>

        <!-- Search Bar with Close Button -->
        <div class="search-wrapper">
            <input type="text" id="searchBar" placeholder="üîç ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶® (‡¶ó‡¶≤‡ßç‡¶™, ‡¶≤‡ßá‡¶ñ‡¶ï ‡¶¨‡¶æ ‡¶≤‡¶æ‡¶á‡¶®...)" onkeyup="filterPosts(this.value)">
            <button class="search-clear" id="searchClearBtn" onclick="clearSearch()"><i class="fas fa-times"></i></button>
        </div>

        <!-- Category Buttons including SAVED -->
        <div class="category-tabs">
            <button class="cat-btn active" onclick="filterCategory('‡¶∏‡¶¨', this)">‡¶∏‡¶¨</button>
            <button class="cat-btn" onclick="filterCategory('‡¶ó‡¶≤‡ßç‡¶™', this)">‡¶ó‡¶≤‡ßç‡¶™</button>
            <button class="cat-btn" onclick="filterCategory('‡¶ï‡¶¨‡¶ø‡¶§‡¶æ', this)">‡¶ï‡¶¨‡¶ø‡¶§‡¶æ</button>
            <button class="cat-btn" onclick="filterCategory('‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø', this)">‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø</button>
            <button class="cat-btn" onclick="filterCategory('‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï', this)">‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï</button>
            <button class="cat-btn" onclick="filterCategory('‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§', this)"><i class="fas fa-bookmark"></i> ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§</button>
            <button class="cat-btn" onclick="filterCategory('‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø', this)">‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø</button>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel">
            <h3 id="formTitle" style="margin-top:0;">‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßã‡¶∏‡ßç‡¶ü</h3>
            <input type="hidden" id="editKey">
            <input type="text" id="authorName" placeholder="‡¶≤‡ßá‡¶ñ‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ">
            <input type="text" id="postTitle" placeholder="‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ">
            
            <select id="postCategory">
                <option value="‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø">‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                <option value="‡¶ó‡¶≤‡ßç‡¶™">‡¶ó‡¶≤‡ßç‡¶™</option>
                <option value="‡¶ï‡¶¨‡¶ø‡¶§‡¶æ">‡¶ï‡¶¨‡¶ø‡¶§‡¶æ</option>
                <option value="‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø">‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø</option>
                <option value="‡¶ó‡¶æ‡¶®">‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡¶ø‡¶ï</option>
                <option value="‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø">‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø</option>
            </select>

            <input type="text" id="postImage" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï (Direct Image URL)">
            <input type="text" id="voiceUrl" placeholder="‡¶Ö‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï (Direct mp3 URL)">
            <textarea id="postContent" rows="5" placeholder="‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®... (*‡¶¨‡ßã‡¶≤‡ßç‡¶°*, _‡¶á‡¶ü‡¶æ‡¶≤‡¶ø‡¶ï_)"></textarea>
            
            <label style="display:flex; align-items:center; margin-bottom:15px; font-size:14px; color:var(--text-color);">
                <input type="checkbox" id="isPinned" style="width:auto; margin-right:10px; transform:scale(1.2);">
                üìå ‡¶è‡¶á ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶ü‡¶ø ‡¶∏‡¶¨‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶™‡¶ø‡¶® ‡¶ï‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®
            </label>

            <button class="btn btn-primary" id="submitBtn" onclick="savePost()">‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <button class="btn" onclick="logout()" style="width:100%; margin-top:10px; background: #e4e6eb; color: black;">‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>

        <div id="loader"><div class="spinner"></div><br>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        <div id="feed"></div>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, set, onValue, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBZtycgadrngON2WEwvIE7ERPYxdkDVfFM",
            authDomain: "muktolipidiary.firebaseapp.com",
            databaseURL: "https://muktolipidiary-default-rtdb.firebaseio.com",
            projectId: "muktolipidiary",
            storageBucket: "muktolipidiary.firebasestorage.app",
            messagingSenderId: "639103995400",
            appId: "1:639103995400:web:13528e51c0e86080770bbd"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        
        // Export Functions globally
        window.savePost = savePost;
        window.deletePost = deletePost;
        window.handleLike = handleLike;
        window.addComment = addComment;
        window.db = db; 
        window.ref = ref;
        window.update = update;
        window.remove = remove;
        window.push = push;
        window.set = set;

        window.allPosts = [];
        
        // Save/Update Post
        function savePost() {
            const title = document.getElementById('postTitle').value;
            const content = document.getElementById('postContent').value;
            const author = document.getElementById('authorName').value || "‡¶Ö‡¶ú‡ßç‡¶û‡¶æ‡¶§";
            const category = document.getElementById('postCategory').value;
            const image = document.getElementById('postImage').value;
            const voice = document.getElementById('voiceUrl').value;
            const isPinned = document.getElementById('isPinned').checked;
            const editKey = document.getElementById('editKey').value;

            if (!title || !content) {
                Swal.fire({ icon: 'warning', title: '‡¶â‡¶´!', text: '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡¶§‡ßá‡¶á ‡¶π‡¶¨‡ßá!' });
                return;
            }

            const postData = {
                author, title, content, image, voice, isPinned, category,
                date: new Date().toLocaleDateString('bn-BD', { year: 'numeric', month: 'long', day: 'numeric' }),
                timestamp: Date.now()
            };

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerText = "‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...";
            submitBtn.disabled = true;

            if (editKey) {
                update(ref(db, 'posts/' + editKey), postData).then(() => resetForm("‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!"));
            } else {
                postData.likes = 0;
                postData.views = 0;
                postData.comments = {};
                const newPostRef = push(ref(db, 'posts'));
                set(newPostRef, postData).then(() => resetForm("‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶π‡ßü‡ßá‡¶õ‡ßá!"));
            }
        }

        function resetForm(msg) {
            Swal.fire({ icon: 'success', title: '‡¶∏‡¶´‡¶≤!', text: msg, timer: 1500, showConfirmButton: false });
            document.getElementById('postTitle').value = "";
            document.getElementById('postContent').value = "";
            document.getElementById('postImage').value = "";
            document.getElementById('voiceUrl').value = "";
            document.getElementById('editKey').value = "";
            document.getElementById('postCategory').value = "‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø";
            document.getElementById('isPinned').checked = false;
            document.getElementById('submitBtn').innerText = "‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®";
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('formTitle').innerText = "‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡ßã‡¶∏‡ßç‡¶ü";
        }

        // Data Load & Sorting
        const loader = document.getElementById('loader');
        loader.style.display = 'block';

        onValue(ref(db, 'posts'), (snapshot) => {
            loader.style.display = 'none';
            const data = snapshot.val();
            const feed = document.getElementById('feed');
            feed.innerHTML = '';
            window.allPosts = [];

            if (data) {
                const postsArr = Object.entries(data).map(([key, value]) => ({ key, ...value }));
                
                postsArr.sort((a, b) => {
                    if (a.isPinned && !b.isPinned) return -1;
                    if (!a.isPinned && b.isPinned) return 1;
                    const likesA = a.likes || 0;
                    const likesB = b.likes || 0;
                    if (likesB !== likesA) return likesB - likesA;
                    return b.timestamp - a.timestamp;
                });

                window.allPosts = postsArr;
                // Determine what to render based on current active tab
                const activeTab = document.querySelector('.cat-btn.active');
                const category = activeTab ? activeTab.innerText.trim() : '‡¶∏‡¶¨';
                
                // If currently on saved tab, re-filter saved, otherwise normal filter
                if(category.includes("‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§")) {
                     filterCategory('‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§', activeTab);
                } else {
                     filterCategory(category, activeTab);
                }
                
            } else {
                feed.innerHTML = '<p style="text-align:center;">‡¶ï‡ßã‡¶®‡ßã ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§</p>';
            }
        });

        function incrementView(key, currentViews) {
            const viewedPosts = JSON.parse(sessionStorage.getItem('VIEWED_POSTS')) || {};
            if (!viewedPosts[key]) {
                update(ref(db, 'posts/' + key), { views: (currentViews || 0) + 1 });
                viewedPosts[key] = true;
                sessionStorage.setItem('VIEWED_POSTS', JSON.stringify(viewedPosts));
            }
        }
        window.incrementView = incrementView;

        // Render Function
        window.renderPosts = function(posts) {
            const feed = document.getElementById('feed');
            const likedPosts = JSON.parse(localStorage.getItem('LIKED_POSTS')) || {};
            const savedPosts = JSON.parse(localStorage.getItem('SAVED_POSTS')) || [];
            let isAdmin = localStorage.getItem('IS_ADMIN') === 'true';

            if(posts.length === 0) {
                feed.innerHTML = `
                <div class="no-results">
                    <i class="fas fa-search-minus" style="font-size:40px; margin-bottom:15px; opacity:0.5;"></i>
                    <h3>‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶ï‡ßã‡¶®‡ßã ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!</h3>
                    <button class="btn btn-primary" onclick="clearSearch()" style="width:auto; margin-top:10px;">‡¶∏‡¶¨ ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
                </div>`;
                return;
            }

            feed.innerHTML = posts.map(post => {
                const isLong = post.content.length > 250;
                const commentsArr = post.comments ? Object.values(post.comments) : [];
                const isSaved = savedPosts.includes(post.key);
                
                let formattedContent = post.content
                    .replace(/\*(.*?)\*/g, '<b>$1</b>')
                    .replace(/_(.*?)_/g, '<i>$1</i>');
                
                setTimeout(() => incrementView(post.key, post.views), 2000); 

                // Audio Button Logic (Now Triggers Sticky Player)
                let audioHtml = '';
                if(post.voice) {
                    audioHtml = `
                    <div class="audio-trigger-btn" onclick="startStickyAudio('${post.key}', '${post.key}', '${post.author}', '${post.voice}')">
                        <i class="fas fa-music"></i> ‡¶∂‡ßÅ‡¶®‡¶§‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                    </div>`;
                }

                return `
                <div class="post-card" id="post-${post.key}">
                    ${post.isPinned ? `<i class="fas fa-thumbtack pinned-badge" title="Pinned Post"></i>` : ''}
                    <div class="author-info">
                        <i class="fas fa-user-circle" style="font-size:20px;"></i> 
                        <div>
                            <span>${post.author}</span>
                            ${post.category ? `<span class="category-tag">${post.category}</span>` : ''}
                            <span class="date">${post.date}</span>
                        </div>
                    </div>
                    <h2 class="post-title">${post.title}</h2>
                    
                    <!-- Image Container with Double Tap -->
                    <div class="post-img-container" ondblclick="triggerDoubleTapLike('${post.key}', event)">
                        ${post.image ? `<img src="${post.image}" class="post-img" onclick="openLightbox('${post.image}')">` : ''}
                        <i class="fas fa-heart heart-popup"></i>
                    </div>

                    ${audioHtml}

                    <!-- Content with Double Tap -->
                    <div class="content-preview" id="text-${post.key}" ondblclick="triggerDoubleTapLike('${post.key}', event)">
                        ${isLong ? formattedContent.substring(0, 250) + "..." : formattedContent}
                        <i class="fas fa-heart heart-popup"></i>
                    </div>
                    ${isLong ? `<button class="read-more-btn" onclick="this.previousElementSibling.innerHTML=\`${formattedContent.replace(/`/g, '\\`')}\`; this.remove()">‡¶Ü‡¶∞‡¶ì ‡¶™‡ßú‡ßÅ‡¶®</button>` : ''}

                    <div class="interaction-bar">
                        <button class="action-btn ${likedPosts[post.key] ? 'liked' : ''}" id="like-btn-${post.key}" onclick="handleLike('${post.key}', ${post.likes || 0})">
                            <i class="fas fa-thumbs-up"></i> <span id="like-count-${post.key}">${post.likes || 0}</span>
                        </button>
                        <button class="action-btn" onclick="toggleComments('${post.key}')">
                            <i class="fas fa-comment-alt"></i> ${commentsArr.length}
                        </button>
                        
                        <!-- Bookmark Button -->
                        <button class="action-btn ${isSaved ? 'bookmarked' : ''}" onclick="toggleBookmark('${post.key}', this)">
                            <i class="fas ${isSaved ? 'fa-bookmark' : 'fa-regular fa-bookmark'}"></i>
                        </button>

                        <button class="action-btn" onclick="">
                            <i class="fas fa-share-nodes"></i>
                        </button>
                    </div>

                    <div class="comment-area" id="commentArea-${post.key}">
                        ${commentsArr.map(c => `<div class="comment-item">${c.text}</div>`).join('')}
                        <div style="display:flex; gap:5px; margin-top:10px;">
                            <input type="text" placeholder="‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." style="margin:0; padding:8px; font-size:13px;">
                            <button onclick="addComment('${post.key}', this)" style="background:var(--primary-color); color:white; border:none; border-radius:8px; width:40px;"><i class="fas fa-paper-plane"></i></button>
                        </div>
                    </div>

                    ${isAdmin ? `
                    <div class="admin-controls">
                        <button onclick="setupEdit('${post.key}')">‡¶è‡¶°‡¶ø‡¶ü</button>
                        <button onclick="deletePost('${post.key}')" style="color:#e74c3c;">‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
                    </div>` : ''}
                </div>`;
            }).join('');
        }

        function handleLike(key, currentLikes) {
            const likedPosts = JSON.parse(localStorage.getItem('LIKED_POSTS')) || {};
            let newCount = currentLikes;
            
            if (!likedPosts[key]) {
                newCount = (currentLikes || 0) + 1;
                update(ref(db, 'posts/' + key), { likes: newCount });
                likedPosts[key] = true;
            } else {
                newCount = (currentLikes || 0) - 1;
                update(ref(db, 'posts/' + key), { likes: newCount });
                delete likedPosts[key];
            }
            localStorage.setItem('LIKED_POSTS', JSON.stringify(likedPosts));
        }

        function addComment(key, btn) {
            const input = btn.previousElementSibling;
            const text = input.value;
            if(!text) return;
            const commentRef = push(ref(db, 'posts/' + key + '/comments'));
            set(commentRef, { text: text, time: Date.now() });
            input.value = '';
        }

        function deletePost(key) {
            if(confirm("‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®?")) remove(ref(db, 'posts/' + key));
        }

        window.setupEdit = function(key) {
            const post = window.allPosts.find(p => p.key === key);
            if(post) {
                document.getElementById('authorName').value = post.author;
                document.getElementById('postTitle').value = post.title;
                document.getElementById('postContent').value = post.content;
                document.getElementById('postImage').value = post.image || "";
                document.getElementById('voiceUrl').value = post.voice || "";
                document.getElementById('postCategory').value = post.category || "‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø";
                document.getElementById('isPinned').checked = post.isPinned || false;
                document.getElementById('editKey').value = post.key;
                document.getElementById('formTitle').innerText = "‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶è‡¶°‡¶ø‡¶ü";
                document.getElementById('submitBtn').innerText = "‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®";
                document.getElementById('adminPanel').style.display = "block";
                window.scrollTo(0, 0);
            }
        }
    </script>

    <script>
        // --- 1. Font Size Resizer Logic ---
        const fontSizes = ['16px', '18px', '20px'];
        let currentFontIndex = 0;

        // Load saved preference
        const savedSize = localStorage.getItem('FONT_SIZE');
        if(savedSize) {
            document.documentElement.style.setProperty('--content-font-size', savedSize);
            currentFontIndex = fontSizes.indexOf(savedSize);
            if(currentFontIndex === -1) currentFontIndex = 0;
        }

        function toggleFontSize() {
            currentFontIndex = (currentFontIndex + 1) % fontSizes.length;
            const newSize = fontSizes[currentFontIndex];
            document.documentElement.style.setProperty('--content-font-size', newSize);
            localStorage.setItem('FONT_SIZE', newSize);
            
            // Visual Feedback
            const btn = document.querySelector('.header-controls .icon-btn');
            btn.style.color = 'var(--primary-color)';
            setTimeout(() => btn.style.color = 'var(--text-color)', 300);
        }

        // --- 2. Bookmark / Saved Feature Logic ---
        function toggleBookmark(key, btn) {
            let savedPosts = JSON.parse(localStorage.getItem('SAVED_POSTS')) || [];
            const index = savedPosts.indexOf(key);
            const icon = btn.querySelector('i');

            if(index === -1) {
                savedPosts.push(key);
                btn.classList.add('bookmarked');
                icon.className = "fas fa-bookmark";
                Swal.fire({
                    toast: true, position: 'top-end', icon: 'success', 
                    title: '‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá', showConfirmButton: false, timer: 1500 
                });
            } else {
                savedPosts.splice(index, 1);
                btn.classList.remove('bookmarked');
                icon.className = "far fa-bookmark";
            }
            localStorage.setItem('SAVED_POSTS', JSON.stringify(savedPosts));
            
            // If currently viewing saved tab, refresh logic
            const activeTab = document.querySelector('.cat-btn.active');
            if(activeTab && activeTab.innerText.includes("‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§")) {
                filterCategory('‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§', activeTab);
            }
        }

        // --- 3. Double Tap to Like Logic ---
        function triggerDoubleTapLike(key, event) {
            // Prevent default zooming
            event.preventDefault();
            
            // Find the heart icon within the container clicked
            const container = event.currentTarget;
            const heart = container.querySelector('.heart-popup');
            
            // Trigger animation
            if(heart) {
                // Reset animation
                heart.style.animation = 'none';
                heart.offsetHeight; /* trigger reflow */
                heart.style.animation = 'popHeart 0.8s ease-out';
            }

            // Trigger actual like in Firebase
            // We get current count from the DOM to avoid async delay
            const countSpan = document.getElementById(`like-count-${key}`);
            const currentLikes = parseInt(countSpan.innerText) || 0;
            
            // Check if already liked to prevent double-counting logic visual glitch
            // The handleLike function toggles, but double tap usually only ADDS like.
            // Here we just call handleLike which toggles. To make it "Instagram like" (only like), 
            // check local storage first.
            const likedPosts = JSON.parse(localStorage.getItem('LIKED_POSTS')) || {};
            if(!likedPosts[key]) {
                window.handleLike(key, currentLikes);
            }
        }

        // --- 4. Sticky Audio Player Logic ---
        const stickyPlayer = document.getElementById('stickyPlayer');
        const audioEl = document.getElementById('globalAudioElement');
        const playIcon = document.getElementById('globalPlayIcon');
        const pTitle = document.getElementById('globalPlayerTitle');
        const pAuthor = document.getElementById('globalPlayerAuthor');
        let currentAudioKey = null;

        function startStickyAudio(key, title, author, url) {
            // If clicking same song, just toggle
            if(currentAudioKey === key) {
                toggleGlobalAudio();
                return;
            }

            // New Song
            currentAudioKey = key;
            pTitle.innerText = title;
            pAuthor.innerText = author;
            audioEl.src = url;
            stickyPlayer.classList.add('active');
            
            audioEl.play().then(() => {
                playIcon.className = "fas fa-pause";
            }).catch(e => console.log(e));
        }

        function toggleGlobalAudio() {
            if(audioEl.paused) {
                audioEl.play();
                playIcon.className = "fas fa-pause";
            } else {
                audioEl.pause();
                playIcon.className = "fas fa-play";
            }
        }

        function closeGlobalPlayer() {
            audioEl.pause();
            audioEl.currentTime = 0;
            stickyPlayer.classList.remove('active');
            currentAudioKey = null;
        }
        
        function onAudioEnded() {
            playIcon.className = "fas fa-play";
        }


        // --- Standard UI Functions ---
        window.filterCategory = function(cat, btn) {
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            document.getElementById('searchBar').value = '';
            document.getElementById('searchClearBtn').style.display = 'none';
            
            if (cat === '‡¶∏‡¶¨') {
                window.renderPosts(window.allPosts);
            } else if (cat === '‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§') {
                // Filter by LocalStorage keys
                const savedIds = JSON.parse(localStorage.getItem('SAVED_POSTS')) || [];
                const filtered = window.allPosts.filter(p => savedIds.includes(p.key));
                if(filtered.length === 0) {
                     document.getElementById('feed').innerHTML = '<div class="no-results"><i class="far fa-bookmark" style="font-size:40px;opacity:0.5;margin-bottom:10px;"></i><p>‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶®‡ßá‡¶á</p></div>';
                } else {
                     window.renderPosts(filtered);
                }
            } else {
                // Filter by Category Text (remove icons if any)
                // The button text might have icon HTML, so we rely on the function arg 'cat'
                // Note: The category values in Firebase are "‡¶ó‡¶≤‡ßç‡¶™", "‡¶ï‡¶¨‡¶ø‡¶§‡¶æ" etc.
                const filtered = window.allPosts.filter(p => p.category === cat);
                window.renderPosts(filtered);
            }
        }

        window.filterPosts = function(query) {
            const clearBtn = document.getElementById('searchClearBtn');
            if (query.length > 0) clearBtn.style.display = 'block';
            else clearBtn.style.display = 'none';

            if(!window.allPosts) return;

            const q = query.toLowerCase();
            const filtered = window.allPosts.filter(p => 
                (p.title && p.title.toLowerCase().includes(q)) || 
                (p.content && p.content.toLowerCase().includes(q)) || 
                (p.author && p.author.toLowerCase().includes(q))
            );
            window.renderPosts(filtered);
        }

        window.clearSearch = function() {
            document.getElementById('searchBar').value = '';
            document.getElementById('searchClearBtn').style.display = 'none';
            window.renderPosts(window.allPosts);
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            document.querySelector('.cat-btn:first-child').classList.add('active');
        }

        // PWA Install Logic
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installBtn').style.display = 'inline-block';
        });

        async function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    document.getElementById('installBtn').style.display = 'none';
                }
                deferredPrompt = null;
            }
        }

        // Scroll Logic
        window.onscroll = function() {
            const btn = document.getElementById('scrollTopBtn');
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        };

        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const icon = document.querySelector('.theme-toggle i');
            icon.classList.toggle('fa-moon');
            icon.classList.toggle('fa-sun');
        }

        function adminLogin() {
            Swal.fire({
                title: '‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®',
                input: 'password',
                showCancelButton: true,
                confirmButtonText: '‡¶≤‡¶ó‡¶á‡¶®',
            }).then((result) => {
                if (result.value === "1234") {
                    localStorage.setItem('IS_ADMIN', 'true');
                    document.getElementById('adminPanel').style.display = "block";
                    document.getElementById('adminBtn').style.display = "none";
                    location.reload();
                } else if (result.value) Swal.fire('‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!', '', 'error');
            });
        }

        function logout() {
            localStorage.setItem('IS_ADMIN', 'false');
            document.getElementById('adminPanel').style.display = "none";
            document.getElementById('adminBtn').style.display = "inline-block";
            location.reload();
        }

        if(localStorage.getItem('IS_ADMIN') === 'true') {
            document.getElementById('adminPanel').style.display = "block";
            document.getElementById('adminBtn').style.display = "none";
        }

        function toggleComments(key) {
            const el = document.getElementById(`commentArea-${key}`);
            el.style.display = (el.style.display === 'block') ? 'none' : 'block';
        }

        function sharePost(key) {
    // ‡ßß. ‡¶∏‡¶¨ ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ
    const post = window.allPosts.find(p => p.key === key);
    
    if (!post) {
        console.error("‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!");
        return;
    }

    // ‡ß®. ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶æ‡¶ú‡¶æ‡¶®‡ßã
    const shareData = {
        title: '‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶≤‡¶ø‡¶™‡¶ø ‡¶°‡¶æ‡ßü‡ßá‡¶∞‡¶ø',
        text: `${post.title}\n\n${post.content.substring(0, 100)}... \n‡¶™‡ßÅ‡¶∞‡ßã‡¶ü‡¶æ ‡¶™‡ßú‡ßÅ‡¶®: `,
        url: window.location.href // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶≤‡¶ø‡¶Ç‡¶ï‡¶ì ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®
    };

    // ‡ß©. ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶Ö‡¶™‡¶∂‡¶® (Web Share API)
    if (navigator.share) {
        navigator.share(shareData)
            .then(() => console.log('‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶π‡ßü‡ßá‡¶õ‡ßá'))
            .catch((error) => console.log('‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá', error));
    } 
    // ‡ß™. ‡¶Ø‡¶¶‡¶ø ‡¶™‡¶ø‡¶∏‡¶ø ‡¶π‡ßü ‡¶¨‡¶æ ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶™‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶ï‡¶™‡¶ø ‡¶π‡¶¨‡ßá
    else {
        navigator.clipboard.writeText(`${shareData.text} ${shareData.url}`)
            .then(() => {
                Swal.fire({
                    icon: 'success',
                    title: '‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!',
                    text: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ñ‡¶® ‡¶è‡¶ü‡¶ø ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§',
                    timer: 1500,
                    showConfirmButton: false
                });
            })
            .catch(err => {
                // ‡¶Ø‡¶¶‡¶ø ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶æ ‡¶™‡¶æ‡¶∞‡ßá
                Swal.fire({
                    icon: 'error',
                    title: '‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ!',
                    text: '‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ‡•§ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®‡•§'
                });
                console.error('Copy failed', err);
            });
    }
}

        function openLightbox(src) {
            const box = document.getElementById('lightbox');
            document.getElementById('lightbox-img').src = src;
            box.style.display = 'flex';
            setTimeout(() => box.classList.add('active'), 10);
        }
        function closeLightbox() {
            const box = document.getElementById('lightbox');
            box.classList.remove('active');
            setTimeout(() => box.style.display = 'none', 300);
        }
    </script>
</body>
</html>